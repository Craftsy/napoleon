define(["exports"],function(t){"use strict";function e(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0});var n=function(){function t(n){var r=this;e(this,t);var o=n.match(/(.*?)($|\?(.*))/),i=o[1],u=o[3];this.url=n,this.components=i.split("/").filter(function(t){return t.length>0}),this.querystring={},null!=u&&u.split("&").forEach(function(t){var e=t.split("="),n=e[0],o=e[1];r.querystring[n]=o})}return t.getComponentKey=function(t){var e=null;return"{"===t.charAt(0)&&"}"===t.charAt(t.length-1)&&(e=t.slice(1,-1)),e},t.prototype.applyState=function(e){for(var n=[],r=this.components.reduce(function(r,o){var i=t.getComponentKey(o);if(n.push(i),null!=i){var u=e[i];null!=u&&(r+="/"+u)}else r+="/"+o;return r},""),o=[],i=Object.keys(e),u=0;u<i.length;u++){var a=i[u];if(-1===n.indexOf(a)){var h=e[a];o.push(a+"="+encodeURIComponent(h))}}return o.length>0&&(r+="?"+o.join("&")),r},t.prototype.extractParameters=function(e){var n=new t(e),r={};this.components.forEach(function(e,o){var i=t.getComponentKey(e);null!=i&&(r[i]=n.components[o])});var o=Object.keys(n.querystring);return o.forEach(function(t){if(!r.hasOwnProperty(t)){var e=n.querystring[t];r[t]=e}}),r},t}();t.URLStructure=n;var r="?dynamic?",o=function(){function t(){e(this,t),this.leaf=null,this.children={}}return t.prototype.addRoute=function(e,o){var i=void 0===arguments[2]?0:arguments[2],u=o.components[i];if(null==u){if(null!=this.leaf)throw new Error("Route "+o.path+" already mounted: "+this.leaf.urlStructure.path);this.leaf={urlStructure:o,handler:e}}else{var a=n.getComponentKey(u),h=null==a?u:r;this.children.hasOwnProperty(h)||(this.children[h]=new t),this.children[h].addRoute(e,o,i+1)}},t.prototype.matchPath=function(t){var e=void 0===arguments[1]?0:arguments[1],n=null;if(e===t.components.length)n=this.leaf;else{var o=t.components[e];this.children.hasOwnProperty(o)&&(n=this.children[o].matchPath(t,e+1)),null==n&&this.children.hasOwnProperty(r)&&(n=this.children[r].matchPath(t,e+1))}return n},t}(),i=function(){function t(){e(this,t),this.trees={GET:new o,POST:new o}}return t.prototype.mount=function(t,e,r){if("GET"!==t&&"POST"!==t)throw new Error("Route method must be either GET or POST");var o=new n(e);this.trees[t].addRoute(r,o)},t.prototype.matchRoute=function(t,e){if("GET"!==t&&"POST"!==t)throw new Error("Route method must be either GET or POST");var r=new n(e);return this.trees[t].matchPath(r)},t.prototype.route=function(t,e){var n=this.matchRoute(t,e);if(null!=n){var r=n.urlStructure.extractParameters(e);n.handler(e,r)}},t}();t.Router=i;var u={};t["default"]=u});